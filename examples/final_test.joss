Import "System.Core"

class Animal {
    string $type = "Animal"
    
    Init constructor($t) {
        $this->type = $t
    }
    
    function getType() {
        return $this->type
    }
    
    function makeSound() {
        print("Generic sound")
    }
}

class Dog extends Animal {
    string $name = "Unknown"
    
    Init constructor($n) {
        $this->name = $n
        $this->type = "Dog"
    }
    
    function makeSound() {
        print($this->name + " says Woof!")
    }
}

class Main {
    Init main() {
        print("=== FINAL JOSSECURITY TEST ===")
        
        // 1. Inheritance & POO
        print("\n[1] Testing Inheritance & POO")
        $d = new Dog("Firulais")
        print("Type: " + $d->getType())
        $d->makeSound()
        
        // 2. Printing Modes
        print("\n[2] Testing Print Modes")
        print("This is print")
        echo "This is echo"
        cout << "This is cout" << "\n"
        printf("This is printf: %s\n", "Formatted")
        
        // 3. Auth & JWT
        print("\n[3] Testing Auth")
        $email = "test_final@joss.com"
        $pass = "secret123"
        
        $db = new GranMySQL()
        $db.query("DELETE FROM js_users WHERE email = '" + $email + "'")
        
        print("Creating user...")
        // Auth.create expects [email, password, name]
        Auth.create([$email, $pass, "Test User"])
        
        print("Attempting login...")
        $token = Auth.attempt($email, $pass)
        ($token != "") ? {
            print("Login successful! Token generated.")
        } : {
            print("Login failed!")
        }
        
        // 4. Sales CRUD (GranMySQL)
        print("\n[4] Testing Sales CRUD")
        $db.query("CREATE TABLE IF NOT EXISTS js_sales (id INT AUTO_INCREMENT PRIMARY KEY, item VARCHAR(255), amount DECIMAL(10,2))")
        $db.query("TRUNCATE TABLE js_sales")
        
        print("Inserting sales...")
        $db.table("sales").insert(["item", "amount"], ["Laptop", 1200.50])
        $db.table("sales").insert(["item", "amount"], ["Mouse", 25.00])
        
        print("Reading sales > 100:")
        $sales = $db.table("sales").where("amount", ">", 100).get()
        print($sales)
        
        // 5. Try-Catch & Throw
        print("\n[5] Testing Try-Catch")
        try {
            print("Throwing error...")
            throw "Critical Error"
        } catch ($e) {
            print("Caught: " + $e)
        }
        
        // 6. Ternary Ladder
        print("\n[6] Testing Ternary Ladder")
        $score = 85
        $grade = ($score >= 90) ? "A" :
                 ($score >= 80) ? "B" :
                 ($score >= 70) ? "C" : "F"
        print("Score: " + $score + ", Grade: " + $grade)
        
        // 7. Block Ternary
        print("\n[7] Testing Block Ternary")
        ($score > 50) ? {
            print("Passed!")
        } : {
            print("Failed!")
        }
        
        print("\n=== TEST COMPLETE ===")
    }
}
