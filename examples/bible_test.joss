@import "global"

class Main {
    Init main() {
        print("=== BIBLE TEST START ===")
        
        // 1. Global Import & Functions
        print("Checking Global Import...")
        $appName = getAppName()
        print("App Name: " + $appName)
        if ($appName == "JosSecurity App") {
            print("✅ Global Import OK")
        } else {
            print("❌ Global Import FAILED")
        }

        // 2. Strict Typing
        print("\nChecking Strict Typing...")
        int $age = 25
        print("Age (int): " + $age)
        
        try {
            $age = "Twenty Five" // Should fail
            print("❌ Strict Typing FAILED (Assignment allowed)")
        } catch ($e) {
            print("✅ Strict Typing OK (Caught error: " + $e + ")")
        }

        // 3. System.load_driver
        print("\nChecking System.load_driver...")
        $sys = new System()
        $sys->load_driver("mysql_driver.dll")
        print("✅ Driver Load Simulated")

        // 4. GranMySQL Joins
        print("\nChecking GranMySQL Joins...")
        $db = new GranMySQL()
        $db->table("users")->select(["users.name", "posts.title"])->innerJoin("posts", "users.id", "=", "posts.user_id")->where("users.active", 1)
        
        // We can't easily verify the generated SQL without mocking DB or checking internal fields
        // But if it runs without error, the method exists.
        print("✅ GranMySQL Join Syntax OK")

        // 5. JSON & TOON
        print("\nChecking JSON/TOON...")
        $data = {"key": "value"}
        $json = json_encode($data)
        print("JSON: " + $json)
        if (json_verify($json)) {
            print("✅ JSON Verify OK")
        } else {
            print("❌ JSON Verify FAILED")
        }

        print("\n=== BIBLE TEST COMPLETE ===")
    }
}
